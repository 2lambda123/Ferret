*DECK CMESH
      SUBROUTINE CMESH (DX,APB,AMB,WID,N,NDIR)
C
C  COSINE MESH
C  APB=A+B = COARSE RESOLUTION
C  AMB=A-B=FINE RESOLUTION
C  WID = WIDTH BETWEEN COARSE & FINE RESOLUTION
C  N = NUMBER OF VARIABLE SPACES CALCULATED TO SPAN WID
C  NDIR = (1,-1) = SPACING (INCREASES,DECREASES) WITH INCREASING INDEX
C
      REAL DX(160)	! changed 100 to 160 : sh 6-13-85
	REAL	apb, amb, wid, a, b, c, pi, rn
	INTEGER	n, ndir, i, ii
      DATA PI/3.14159/
      A=.5*(APB+AMB)
      B=.5*(APB-AMB)
      C=WID/A
      N=C+.1
      RN=1./FLOAT(N)
      DO 20 II=1,N
      IF (NDIR.EQ.1) I=N+1-II
      IF (NDIR.EQ.-1)  I=II
   20 DX(I)=A+B*COS(PI*RN*(II-.5))
      RETURN
      END
