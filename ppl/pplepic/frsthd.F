      SUBROUTINE FRSTHD(ITAPEI,NCAST,NDATA)
C** 
C**    @(#)frsthd.f	1.1    3/10/88
C**
C**
C***********************************************************************        C**
C**                 EPIC
C**
C***********************************************************************        C**
C**
C  THIS SUBROUTINE WILL READ 1  HEADER FROM A  CAST THAT IS LOCATED ON
C  TAPE ITAPEI. IT WILL RETURN THE VALUES FOR CAST NUMBER AND NUMBER OF 
C  DATA POINTS IN NCAST AND NDATA.  HEADER INFORMATION WIL BE RETURNED 
C  IN HEADER.
C
C  PROGRAMMED 10/84 BY M. VERSCHELL
C
      CHARACTER*80 HEADER(8)
      COMMON /COMHDR/ HEADER
C
C  READ IN HEADER FROM TAPE ITAPEI
C
      READ (ITAPEI) HEADER(1)
      GOTO 100
   99 READ (ITAPEI,END=9000) HEADER(1)
  100 DO 150 J=2,8
      READ (ITAPEI,END=9000) HEADER(J)
  150 CONTINUE 
C
C  IF HEADER READ IN CORRECTLY, ISOLATE AND CONVERT NCAST AND NDATA
C
      READ(HEADER(1)(17:19),200) NCAST
  200 FORMAT(I3)
      READ(HEADER(3)(55:60),300) NDATA
  300 FORMAT(I6)
      RETURN
C
C  HERE BEGINS THE ERROR HANDLING CODE
C
 9000 WRITE (6,9100) NERROR
 9100 FORMAT(1X,'FORTRAN RUN TIME ERROR #',I2)
      IF (NERROR .EQ. -1) WRITE (6,9200)
 9200 FORMAT(1X,'END OF FILE READ BEFORE ALL OF HEADER READ')
      IF (NERROR .EQ. 29) WRITE (6,9300)
 9300 FORMAT(1X,'TAPE 1 NOT ASSIGNED (FOR001.DAT NOT FOUND)')
      IF (NERROR .EQ. 61) WRITE (6,9400)
 9400 FORMAT(1X,'ERROR IN CONVERSION OF NCAST OR NDATA')
      STOP
      END
