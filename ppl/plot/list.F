      SUBROUTINE LIST(LLUN,X,NSIZE,ARG)
	DIMENSION X(NSIZE) 
C** 
C**    @(#)list.F	1.1    3/10/88
C**
C**
C***********************************************************************
C**
C**                 PLOT+ Scientific Graphics System
C**
C***********************************************************************
C**
C**
#ifdef unix
	INCLUDE 'pplinc/PARAMPL5.DAT'
	INCLUDE 'pplinc/AXIS.INC'
	INCLUDE 'pplinc/LINES.INC'
	INCLUDE 'pplinc/PEN.INC'
	INCLUDE 'pplinc/LABELS.INC'
	INCLUDE 'pplinc/LABCOM.INC'
	INCLUDE 'pplinc/CONT.INC'
	INCLUDE 'pplinc/DASHZZ.INC'
	INCLUDE 'pplinc/CONLAB.INC'
	INCLUDE 'pplinc/PLT.INC'
	INCLUDE 'pplinc/HAB.INC'
	INCLUDE 'pplinc/DATA.INC'
	INCLUDE 'pplinc/CMRD.INC'
	INCLUDE 'pplinc/CMRDL.INC'
	INCLUDE 'pplinc/HD.INC'
	INCLUDE 'pplinc/TAXIS.INC'
	INCLUDE 'pplinc/TICS.INC'
	INCLUDE 'pplinc/TICS2.INC'
	INCLUDE 'pplinc/AXISL.INC'
	INCLUDE 'pplinc/XYLABP.INC'
	INCLUDE 'pplinc/MISS.INC'
	INCLUDE 'pplinc/ZGRID.INC'
	INCLUDE 'pplinc/LUNITS.INC'
	INCLUDE 'pplinc/VECTOR.INC'
	INCLUDE 'cmdinc/SYSTEM.INC'
#else
        INCLUDE 'pplinc:PARAMPL5.DAT'
        INCLUDE 'pplinc:AXIS.INC'
        INCLUDE 'pplinc:LINES.INC'
        INCLUDE 'pplinc:PEN.INC'
        INCLUDE 'pplinc:LABELS.INC'
        INCLUDE 'pplinc:LABCOM.INC'
        INCLUDE 'pplinc:CONT.INC'
        INCLUDE 'pplinc:DASHZZ.INC'
        INCLUDE 'pplinc:CONLAB.INC'
        INCLUDE 'pplinc:PLT.INC'
        INCLUDE 'pplinc:HAB.INC'
        INCLUDE 'pplinc:DATA.INC'
        INCLUDE 'pplinc:CMRD.INC'
        INCLUDE 'pplinc:CMRDL.INC'
        INCLUDE 'pplinc:HD.INC'
        INCLUDE 'pplinc:TAXIS.INC'
        INCLUDE 'pplinc:TICS.INC'
        INCLUDE 'pplinc:TICS2.INC'
        INCLUDE 'pplinc:AXISL.INC'
        INCLUDE 'pplinc:XYLABP.INC'
        INCLUDE 'pplinc:MISS.INC'
        INCLUDE 'pplinc:ZGRID.INC'
        INCLUDE 'pplinc:LUNITS.INC'
        INCLUDE 'PPLINC:VECTOR.INC'
        INCLUDE 'CMDINC:SYSTEM.INC'
#endif
	COMMON/PLTCM2/PMODE,FILEZ,FILET
	CHARACTER PMODE*1,FILEZ*81,FILET*81
	CHARACTER ARG*30,LST(17)*10,AUTO(2)*6,TYPEL(6)*12,CLEV(3)*4
	CHARACTER TYPE(3)*7,JTY(-2:2)*30,TIC(-1:1)*7
	CHARACTER LT(-1:1)*6,AT(0:2)*7,IZT(0:3)*8,TAXTYP(-1:1)*5
	CHARACTER SYM*20,SYM2*20,SYM3*20,ONOFF(0:1)*3
	DATA LST/'XAXIS','YAXIS','LINES','LABELS','STATS','LEVELS', 
     *'READ','CONSET','LABSET','TAXIS','TICS','DATA','PLOT','DATPT',
     *'TRANSXY','LIMITS','VECTOR'/
	DATA AUTO/'MANUAL','AUTO'/,ONOFF/'OFF','ON'/
	DATA TAXTYP/'YAXIS','OFF','XAXIS'/
	DATA IZT/'OFF','X AXIS','Y AXIS','POINTS'/
	DATA TYPEL/'NO MARK','MARK','END PTS','ONLY MARK', 
     *'DASH','DASH END PTS'/,CLEV/'LINE','DARK','DASH'/ 
	DATA TIC/'OUTSIDE','BOTH','INSIDE'/ 
	DATA JTY/'VECTOR VARIABLE GRID','VECTOR','CONTOUR',
     *		'LINES','CONTOUR VARIABLE GRID'/
	DATA TYPE/'NORMAL','LOG','INV LOG'/ 
	DATA LT/'LEFT','CENTER','RIGHT'/,AT/'NO LINE','LINE','FANCY'/
	IF(QUIETF)RETURN
	CALL UPPER(ARG,30)
	DO 10 I=1,17
	IF(ARG.EQ.LST(I))GOTO 11 
10    CONTINUE 
      WRITE(LTTOUT,9986) ARG 
9986  FORMAT(' ILLEGAL LIST OPTION',2X,A10) 
      GOTO 5000 
11    GOTO (100,200,300,400,500,600,700,800,900,1000,1100,500,1300,
     *	1400,1500,1600,1700),I 
C     XAXIS 
100   WRITE(LLUN,'(//9X,''XAXIS QUALITIES'')') 
      WRITE(LLUN,9999)XLO,XHI,XTIC,XLEN,XCSIZE,
     *ONOFF(IAXON(1)),ONOFF(IAXON(2))
9999  FORMAT(9X,'LO=',1PE9.2,' HI=',E9.2,' TIC=',E9.2, 
     *' LEN=',E9.2,' CSIZE=',E9.2,/,9X,' TOP AXIS= ',A3,
     *' BOTTOM AXIS= ',A3)
      WRITE(LLUN,9998)AUTO(IAUTOX+1),TYPE(ITYPEX),NMTCX,LINTX, 
     *LABELX,NSIGX,NTICX 
9998  FORMAT(9X,A6,2X,A6,' NMTC=',I3,' LINT=',I3,' LABEL=', 
     *I3,' NSIG=',I3,' NTIC=',I3) 
      IF(IFRX.EQ.' ')THEN 
      WRITE(LLUN,9988) XORG 
9988  FORMAT(9X,'XORG=',1PE9.2,'  AUTO LABELLING') 
      ELSE 
      WRITE(LLUN,9987) XORG,IFRX 
9987  FORMAT(9X,'XORG=',1PE9.2,'  LABEL FORMAT=',2X,A20) 
      ENDIF 
      GOTO 5000 
C     YAXIS 
200   WRITE(LLUN,'(//9X,''YAXIS QUALITIES'')') 
      WRITE(LLUN,9975)YLO,YHI,YTIC,YLEN,YCSIZE,
     *ONOFF(IAXON(3)),ONOFF(IAXON(4))
9975  FORMAT(9X,'LO=',1PE9.2,' HI=',E9.2,' TIC=',E9.2, 
     *' LEN=',E9.2,' CSIZE=',E9.2,/,9X,' LEFT AXIS= ',A3,
     *' RIGHT AXIS= ',A3)
      WRITE(LLUN,9998)AUTO(IAUTOY+1),TYPE(ITYPEY),NMTCY,LINTY, 
     *LABELY,NSIGY,NTICY 
      IF(IFRY.EQ.' ')THEN 
      WRITE(LLUN,9988) YORG 
      ELSE 
      WRITE(LLUN,9987) YORG,IFRY 
      ENDIF 
      GOTO 5000 
C     LINES 
300   WRITE(LLUN,9996) 
9996  FORMAT(//8X,'MARK',3X,'TYPE',5X,'MARKH',3X,'DN1', 
     *3X,'UP1',3X,'DN2',3X,'UP2',2X,'LEN',2X,'PEN') 
      DO 301 I=1,LNUM 
      WRITE(LLUN,9997)IMARK(I),TYPEL(ITYPE(I)+1),HMARK(I),DN1(I), 
     *UP1(I),DN2(I),UP2(I),LLENG(I),IPEN(I) 
9997  FORMAT(8X,I2,1X,A12,5F6.3,I6,I4) 
301   CONTINUE 
	WRITE(LLUN,9981)IPEN(0)
9981	FORMAT(/8X,'DEFAULT PEN= ',I2)
      GOTO 5000 
C     LABELS 
400   WRITE(LLUN,9991)LAB1 
9991  FORMAT(1X,A79) 
      WRITE(LLUN,9991)XLAB 
      WRITE(LLUN,9991)YLAB 
	IF(NLAB.NE.0)WRITE(LLUN,9979)
9979	FORMAT(/10X,'XPOS',7X,'YPOS',5X,'HGT',3X,'ROT',3X,'UNITS')
      DO 403 I=1,NLAB 
	NCR=LNBLK(LABS(I),255)
	IF(USRLBS(I))THEN
	    SYM='USER'
	ELSE
	    SYM='SYSTEM'
	ENDIF
      WRITE(LLUN,9980)I,XLABS(I),YLABS(I),RHLABS(I),INT(RLABS(I)),
     *SYM,LABS(I)(:NCR)
9980	FORMAT(' LAB',I2,1P2E11.3,0PF6.3,I5,2X,A6,2X,A)
	WRITE(LLUN,9974)XLLABS(I),YLLABS(I),AT(LLTYPE(I)),LT(LTYPE(I))
9974	FORMAT(' LINE PT:',3X,1P2E10.3,2X,A7,5X,A6,' JUSTIFY LABEL')
403	CONTINUE
      GOTO 5000 
C     STATS 
500   WRITE(LLUN,9995)JTY(JTYPE) 
9995  FORMAT(//9X,'DATA OF TYPE',1X,A) 
      WRITE(LLUN,9994)XMIN,XMAX,YMIN,YMAX,ZMIN,ZMAX 
9994  FORMAT(19X,'MIN',12X,'MAX'/9X,'X',1P2E15.4/ 
     *9X,'Y',2E15.4/9X,'Z',2E15.4) 
      IF(JTYPE.LE.0.OR.JTYPE.EQ.2)THEN 
      WRITE(LLUN,'(9X,''NX='',I4,'' NY='',I4)')NX,NY 
      ELSE 
      WRITE(LLUN,'(9X,''LINE'',I3,'' READ'')')LINEN
      DO 501 I=1,LNUM 
      WRITE(LLUN,'(9X,''LINE='',I2,''  LEN='',I6)')I,LLENG(I) 
501	CONTINUE
      END IF
	IF(ARG.EQ.LST(12))GOTO 1200 
      GOTO 5000 
C     LEVELS 
600   WRITE(LLUN,'(//9X,''LEVEL'',7X,''TYPE'',7X,''NDIG'',7X,''PEN'')') 
      NL=NLEV2 
      IF(IAUTOC.EQ.0)NL=NLEV 
      DO 601 I=1,NL 
	NDEC=LDIG(I)
	ICOLR=LCLR(I)
      WRITE(LLUN,'(9X,1PE9.2,3X,A6,2I9)')ZLEV(I),CLEV(LWGT(I)),NDEC,
     *ICOLR
601	CONTINUE
      GOTO 5000 
C     READ 
700   WRITE(LLUN,9990)IFORM,ITYPEZ,JTY(JTYPE) 
9990  FORMAT(//9X,'THE FORMAT IS'/9X,A80/9X,'ITYPEZ=',I2, 
     *'  DATA IS ',A7) 
      WRITE(LLUN,9989)JX,JY,JZ,NVAR,NGRP,NREC,LINEN,NX,NY 
9989  FORMAT(9X,'JX=',I2,'  JY=',I2,'  JZ=',I2/ 
     *9X,'NO. VARS PER GROUP=',I6/9X,'NO. GRPS PER RECORD=',I6/ 
     *9X,'NO. OF RECORDS=',I6/9X,'LINEN=',I6,'  NX=',I6,'  NY=',I6) 
      GOTO 5000 
C     CONSET 
800   WRITE(LLUN,9993)HGT,NSIGC,NARC,DASHLN,SPACLN,CAY,NRNG,DSLAB,
     *CANGLE
9993  FORMAT(//9X,'CONTOUR CONSTANTS'/9X,'HGT=',1PE9.2,' NSIG=',I3, 
     *' NARC=',I3,' DASHLN=',E9.2,/9X,'SPACLN=',E9.2,' CAY=', 
     *E9.2,' NRNG=',I3,' DSLAB=',E9.2,' ANGLE=',G9.2)
      WRITE(LLUN,9971)CONPRE,CONPST
9971  FORMAT(9X,'LABEL PREFIX= ',A10,'   POSTFIX= ',A10) 
      GOTO 5000 
C     LABSET 
900   WRITE(LLUN,'(//9X,''LABEL CHAR HEIGHTS'')') 
      WRITE(LLUN,9992)HLAB1,HXLAB,HYLAB,HLABS 
9992  FORMAT(9X,'HLAB1=',1PE9.2,' HXLAB=',E9.2,' HYLAB=', 
     *E9.2,' HLABS=',E9.2) 
      GOTO 5000 
C     TAXIS 
1000  WRITE(LLUN,'(//9X,''TAXIS QUALITITES'')') 
      WRITE(LLUN,9985)TLO,DT,TCSIZE,ITYPET,VANG,
     *ONOFF(IAXON(1)),ONOFF(IAXON(2))
9985  FORMAT(9X,'LO=',1PE9.2,' DT=',E9.2,' CSIZE=',E9.2, 
     *' TYPE= TAXIS',I1,' VANG=',E9.2,/,9X,' TOP AXIS= ',A3,
     *' BOTTOM AXIS= ',A3)
      CALL TIME2(IT1,SYM) 
      CALL TIME2(IT2,SYM2)
	CALL TIME2(ITSTRT,SYM3) 
      WRITE(LLUN,9984)IT1,SYM,IT2,SYM2,ITSTRT,SYM3,NMTCT,LABELT,
     *IFDB,ISDB,TAXTYP(ITFLG),onoff(iautot)
9984  FORMAT(9X,'  TMIN=',A10,A20,/9X,'  TMAX=',A10,A20/9X,'TSTART=',
     *A10,A20,/9X,'NMTC=',I3,' LABEL=',I3,' IFDB=',I3,' ISDB=',I3,
     *' TAXIS= ',A5,' IAUTOT= ',a3)
      GOTO 5000 
C     TICS 
1100  WRITE(LLUN,9983)TSMX,TLX,TSMY,TLY 
9983  FORMAT(9X,'SMALL XTIC=',1PE10.3,'   LARGE XTIC=',E10.3, 
     */9X,'SMALL YTIC=',E10.3,'   LARGE YTIC=',E10.3) 
      WRITE(LLUN,9982)TIC(ITX),TIC(ITY) 
9982  FORMAT(9X,'X AXIS TICS ',A7,'   Y AXIS TICS ',A7) 
	GOTO 5000
C	DATA
1200	CALL DATLST(LLUN,X,NSIZE,NX,NY)
	GOTO 5000
C	PLOT
1300	WRITE(LLUN,9977)WIDTH,HEIGHT,MOD,IR
9977	FORMAT(9X,'WIDTH= ',F7.2,'  HEIGHT= ',F7.2,'  TKTYPE=',I5
     *	,'  BAUD=',I5)
	WRITE(LLUN,9978)ONOFF(IWIND),ONOFF(IP(1)),ICROSS,ICODE
9978	FORMAT(9X,'WINDOW= ',A3,'  BOX= ',A3,'  CROSS=',I2,
     *	'  PLTYPE=',I3)
	WRITE(LLUN,9972)PMODE,FILEZ
9972	FORMAT(9X,'PLOT MODE= ',A3,4X,'PLOT FILE= ',A40)
	GOTO 5000
C	DATPT
1400	WRITE(LLUN,9973)IZT(IZTYP),IZMRK,IZLEN
9973	FORMAT(9X,'GRID POINTS = ',A8,' MARK= ',I4,' LEN=',I10)
	GOTO 5000
C	TRANSXY
1500	WRITE(LLUN,9970)
9970	FORMAT(9X,'LINE',4X,'XFACT',5X,'XOFF',6X,'YFACT',4X,'YOFF')
	DO 1501 I=1,LNUM
	WRITE(LLUN,9969)I,XFCT(I),XOFF(I),YFCT(I),YOFF(I)
9969	FORMAT(9X,I3,1X,1P4E10.2)
1501	CONTINUE
	GOTO 5000
C	LIMITS
1600	WRITE(LLUN,9976)XLE,CMXLE,XEQ,CMXEQ,XGE,CMXGE,
     *	YLE,CMYLE,YEQ,CMYEQ,YGE,CMYGE,
     *	ZLE,CMZLE,ZEQ,CMZEQ,ZGE,CMZGE
9976	FORMAT(9X,'TEST',4X,'TRUE/FALSE',7X,'VALUE'//
     *	10X,'XLE',8X,L1,8X,1PE11.3/
     *	10X,'XEQ',8X,L1,8X,1PE11.3/
     *	10X,'XGE',8X,L1,8X,1PE11.3/
     *	10X,'YLE',8X,L1,8X,1PE11.3/
     *	10X,'YEQ',8X,L1,8X,1PE11.3/
     *	10X,'YGE',8X,L1,8X,1PE11.3/
     *	10X,'ZLE',8X,L1,8X,1PE11.3/
     *	10X,'ZEQ',8X,L1,8X,1PE11.3/
     *	10X,'ZGE',8X,L1,8X,1PE11.3)
	GOTO 5000
C	VECTOR
1700	WRITE(LLUN,9968)VLEN,VUSRLN,VAUTO
9968	FORMAT(9X,'SCALE LENGTH = ',F5.3,'  SCALE = ',1PG10.3,
     *	'  AUTO SCALE = ',L)
	WRITE(LLUN,9967)VXLOC,VYLOC,VUSER,VKEY,LT(IFIX(VPOS)),VFRMT
9967	FORMAT(9X,'XPOS = ',1PG10.3,'  YPOS = ',G10.3,
     *	'  USER = ',L,'  DRAW KEY = ',L/9X,'JUSTIFY ',A8,2X,A20)
5000	RETURN
      END 
