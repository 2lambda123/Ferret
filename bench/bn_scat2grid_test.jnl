! bn_scat2grid_test.jnl
! From JonCallahan's insitu_gaussian_*.jnl

! Description: Test functions for XY XZ XT YZ YT ZT gridding of insitu data

set data scat2grid.nc

define axis/x=50:70/npoints=20/units=degrees_east x_20
define axis/y=10:20/npoints=20/units=degrees_north y_20
define axis/z=0:100/npoints=20/depth/units=meters z_20
define axis/t=0:8736/unit=hours/t0="01-JAN-1995 00:00:00"/npoints=20 t_20

!*********
! SCAT2GRIDGAUSS functions
! XY

let xy_gauss_gridded = scat2gridgauss_xy(xpts,ypts,O2_umol_kg,x[gx=x_20],y[gy=y_20],1.5,1.0,5.0,3.0)
fill/lev=30v xy_gauss_gridded
plot/vs/over/nolab xpts,ypts
ppl shaset reset

! XZ

let xz_gauss_gridded = scat2gridgauss_xz(xpts,zpts,O2_umol_kg,x[gx=x_20],z[gz=z_20],1.5,10,2,20)
fill/lev=30v xz_gauss_gridded
plot/vs/over/nolab xpts,zpts
ppl shaset reset

! XT

let xt_gauss_gridded = scat2gridgauss_xt(xpts,tpts,O2_umol_kg,x[gx=x_20],t[gt=t_20],1.5,720.0,5.0,2160.0)
fill/lev=30v xt_gauss_gridded
plot/vs/over/nolab xpts,tpts
ppl shaset reset

! YZ

let yz_gauss_gridded = scat2gridgauss_yz(ypts,zpts,ysequence(O2_umol_kg),y[gy=y_20],z[gz=z_20],1.0,10,3,50)
fill/lev=30v yz_gauss_gridded
plot/vs/over/nolab ypts,zpts
ppl shaset reset

! YT

let yt_gauss_gridded = scat2gridgauss_yt(ypts,tpts,ysequence(O2_umol_kg),y[gy=y_20],t[gt=t_20],1.0,720,3,2160)
fill/lev=30v yt_gauss_gridded
plot/vs/over/nolab tpts,ypts
ppl shaset reset

! ZT

let zt_gauss_gridded = scat2gridgauss_zt(zpts,tpts,zsequence(O2_umol_kg),z[gz=z_20],t[gt=t_20],10,720,50,2160)
fill/lev=30v zt_gauss_gridded
plot/vs/over/nolab tpts, zpts

can mem/all

! SCAT2GRIDLAPLACE functions
exit/script  ! This crashes when scat2gridlaplace_xy loaded, only when 
	     ! run as part of the benchmark suite
! XY

let xy_laplace_gridded = scat2gridlaplace_xy(xsequence(xpts),xsequence(ypts),xsequence(O2_umol_kg),x[gx=x_20],y[gy=y_20],2,2)
fill/lev=30v xy_laplace_gridded
plot/vs/over/nolab xpts,ypts
ppl shaset reset

! XZ

let xz_laplace_gridded = scat2gridlaplace_xz(xpts,zpts,O2_umol_kg,x[gx=x_20],z[gz=z_20],2,2)
fill/lev=30v xz_laplace_gridded
plot/vs/over/nolab xpts,zpts
ppl shaset reset

! XT

let xt_laplace_gridded = scat2gridlaplace_xt(xpts,tpts,O2_umol_kg,x[gx=x_20],t[gt=t_20],2,2)
fill/lev=30v xt_laplace_gridded
plot/vs/over/nolab xpts,tpts
ppl shaset reset

! YZ

let yz_laplace_gridded = scat2gridlaplace_yz(ypts,zpts,ysequence(O2_umol_kg),y[gy=y_20],z[gz=z_20],2,2)
fill/lev=30v yz_laplace_gridded
plot/vs/over/nolab ypts,zpts
ppl shaset reset

! YT

let yt_laplace_gridded = scat2gridlaplace_yt(ypts,tpts,ysequence(O2_umol_kg),y[gy=y_20],t[gt=t_20],2,2)
fill/lev=30v yt_laplace_gridded
plot/vs/over/nolab tpts,ypts
ppl shaset reset

! ZT

let zt_laplace_gridded = scat2gridlaplace_zt(zpts,tpts,zsequence(O2_umol_kg),z[gz=z_20],t[gt=t_20],2,2)
fill/lev=30v zt_laplace_gridded
plot/vs/over/nolab tpts, zpts
pause
